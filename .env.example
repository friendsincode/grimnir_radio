# Grimnir Radio - Environment Configuration
# Copy this file to .env and customize for your deployment

# =============================================================================
# GRIMNIR RADIO - CONTROL PLANE
# =============================================================================

# Environment: development, staging, production
ENVIRONMENT=production

# Log Level: debug, info, warn, error
LOG_LEVEL=info

# HTTP Server
GRIMNIR_HTTP_BIND=0.0.0.0
GRIMNIR_HTTP_PORT=8080

# =============================================================================
# DATABASE
# =============================================================================

# PostgreSQL (recommended for production)
POSTGRES_PASSWORD=grimnir_secret_change_me

# Database backend: postgres, mysql, sqlite
GRIMNIR_DB_BACKEND=postgres

# Connection string (auto-configured for Docker Compose postgres service)
# For external DB, set: host=your-db-host port=5432 user=grimnir password=... dbname=grimnir
GRIMNIR_DB_DSN=host=postgres port=5432 user=grimnir password=grimnir_secret_change_me dbname=grimnir sslmode=disable

# =============================================================================
# REDIS (Event Bus & Leader Election)
# =============================================================================

REDIS_PASSWORD=redis_secret_change_me
GRIMNIR_REDIS_ADDR=redis:6379
GRIMNIR_REDIS_DB=0

# =============================================================================
# LEADER ELECTION (Multi-Instance)
# =============================================================================

# Enable leader election for multi-instance deployments
LEADER_ELECTION_ENABLED=false

# Unique instance ID (change for each instance in multi-instance setup)
GRIMNIR_INSTANCE_ID=grimnir-1

# =============================================================================
# MEDIA ENGINE
# =============================================================================

# gRPC address of media engine (auto-configured for Docker Compose)
GRIMNIR_MEDIA_ENGINE_GRPC_ADDR=mediaengine:9091

# Media engine log level
MEDIAENGINE_LOG_LEVEL=info

# =============================================================================
# AUTHENTICATION
# =============================================================================

# JWT signing key (CHANGE THIS IN PRODUCTION!)
JWT_SIGNING_KEY=change-this-to-a-random-secret-in-production

# JWT token time-to-live in minutes
GRIMNIR_JWT_TTL_MINUTES=15

# =============================================================================
# MEDIA STORAGE
# =============================================================================

# Media storage backend: filesystem, s3
GRIMNIR_MEDIA_BACKEND=filesystem

# Filesystem path for media files
GRIMNIR_MEDIA_ROOT=/var/lib/grimnir/media

# S3 Configuration (if using s3 backend)
# GRIMNIR_S3_BUCKET=grimnir-media
# GRIMNIR_S3_REGION=us-east-1
# GRIMNIR_S3_ACCESS_KEY_ID=your-access-key
# GRIMNIR_S3_SECRET_ACCESS_KEY=your-secret-key
# GRIMNIR_S3_ENDPOINT=https://s3.amazonaws.com

# =============================================================================
# SCHEDULER
# =============================================================================

# How far ahead to generate schedule (e.g., 48h, 72h, 168h)
GRIMNIR_SCHEDULER_LOOKAHEAD=48h

# Scheduler tick interval (e.g., 30s, 1m)
GRIMNIR_SCHEDULER_TICK_INTERVAL=30s

# =============================================================================
# OBSERVABILITY
# =============================================================================

# OpenTelemetry Tracing
TRACING_ENABLED=false
OTLP_ENDPOINT=
TRACING_SAMPLE_RATE=0.1

# Prometheus metrics bind address
GRIMNIR_METRICS_BIND=0.0.0.0:9000

# =============================================================================
# ICECAST2 STREAMING SERVER
# =============================================================================

# Icecast admin credentials
ICECAST_ADMIN_USERNAME=admin
ICECAST_ADMIN_PASSWORD=hackme_change_this
ICECAST_ADMIN_EMAIL=admin@localhost

# Icecast source password (used by media engine to connect)
ICECAST_SOURCE_PASSWORD=hackme_change_this

# Icecast relay password (for relay configurations)
ICECAST_RELAY_PASSWORD=hackme_change_this

# Icecast server settings
ICECAST_HOSTNAME=localhost
ICECAST_LOCATION=Earth
ICECAST_PORT=8000

# Icecast limits
ICECAST_MAX_CLIENTS=100
ICECAST_MAX_SOURCES=10

# =============================================================================
# WEBSTREAM CONFIGURATION
# =============================================================================

# Allowed URL schemes for webstream relaying
GRIMNIR_WEBSTREAM_ALLOWED_SCHEMES=http,https

# Connection timeout in milliseconds
GRIMNIR_WEBSTREAM_CONNECT_TIMEOUT_MS=5000

# Read timeout in milliseconds
GRIMNIR_WEBSTREAM_READ_TIMEOUT_MS=15000

# Reconnect backoff in milliseconds
GRIMNIR_WEBSTREAM_RECONNECT_BACKOFF_MS=1000

# Preflight check timeout in milliseconds
GRIMNIR_WEBSTREAM_PREFLIGHT_MS=3000

# Grace period before failover in milliseconds
GRIMNIR_WEBSTREAM_GRACE_MS=5000

# Maximum number of failover URLs to try
GRIMNIR_WEBSTREAM_FALLBACK_LIMIT=3

# =============================================================================
# ADVANCED SETTINGS
# =============================================================================

# CORS allowed origins (comma-separated)
# GRIMNIR_CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# Rate limiting (requests per minute)
# GRIMNIR_RATE_LIMIT_RPM=1000

# Global max upload size override for web multipart uploads (in MB).
# If unset, endpoint defaults apply (media 1024, playlist covers 5, landing assets 10, imports 100).
# GRIMNIR_MAX_UPLOAD_SIZE_MB=1024
