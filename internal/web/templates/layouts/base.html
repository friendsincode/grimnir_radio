{{define "layouts/base"}}
<!DOCTYPE html>
<html lang="en" data-bs-theme="{{.Theme}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - Grimnir Radio</title>

    <!-- Bootstrap CSS (CDN with fallback) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous"
          onerror="this.onerror=null;this.href='/static/css/bootstrap.min.css';">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet"
          onerror="this.onerror=null;this.href='/static/css/bootstrap-icons.min.css';">

    <!-- Theme CSS -->
    <link href="/static/css/themes/{{.Theme}}.css" rel="stylesheet">
    <link href="/static/css/app.css" rel="stylesheet">

    {{block "head" .}}{{end}}
</head>
<body class="{{block "bodyClass" .}}{{end}}">
    {{block "content" .}}{{end}}

    <!-- Bootstrap JS Bundle (CDN with fallback) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"
            onerror="this.onerror=null;this.src='/static/js/bootstrap.bundle.min.js';"></script>

    <!-- HTMX (CDN with fallback) -->
    <script src="https://unpkg.com/htmx.org@1.9.12"
            integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"
            onerror="this.onerror=null;this.src='/static/js/htmx.min.js';"></script>

    <!-- Alpine.js for small interactions -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.3/dist/cdn.min.js"
            onerror="this.onerror=null;this.src='/static/js/alpine.min.js';"></script>

    <!-- App JS -->
    <script src="/static/js/app.js"></script>

    {{block "scripts" .}}{{end}}

    <!-- Global Audio Player Bar -->
    <div id="globalPlayer" class="global-player" style="display: none;">
        <div class="global-player-progress" id="globalPlayerProgress">
            <div class="global-player-progress-bar" id="globalPlayerProgressBar"></div>
        </div>
        <div class="container-fluid">
            <div class="row align-items-center py-2">
                <!-- Track Info -->
                <div class="col-4 col-md-3 d-flex align-items-center gap-2">
                    <div id="playerArtwork" class="player-artwork">
                        <i class="bi bi-music-note-beamed"></i>
                    </div>
                    <div class="player-info text-truncate">
                        <div id="playerTitle" class="fw-semibold text-truncate">-</div>
                        <div id="playerArtist" class="small text-body-secondary text-truncate">-</div>
                    </div>
                </div>

                <!-- Controls -->
                <div class="col-4 col-md-6 d-flex justify-content-center align-items-center gap-2">
                    <button class="btn btn-sm btn-link text-body" id="playerPrev" title="Previous">
                        <i class="bi bi-skip-start-fill fs-5"></i>
                    </button>
                    <button class="btn btn-light rounded-circle d-flex align-items-center justify-content-center"
                            id="playerPlayPause" style="width: 42px; height: 42px;">
                        <i class="bi bi-play-fill fs-4" id="playerPlayIcon"></i>
                    </button>
                    <button class="btn btn-sm btn-link text-body" id="playerNext" title="Next">
                        <i class="bi bi-skip-end-fill fs-5"></i>
                    </button>
                </div>

                <!-- Time & Volume -->
                <div class="col-4 col-md-3 d-flex justify-content-end align-items-center gap-3">
                    <span class="small text-body-secondary d-none d-md-inline">
                        <span id="playerCurrentTime">0:00</span> / <span id="playerDuration">0:00</span>
                    </span>
                    <div class="d-none d-md-flex align-items-center gap-2">
                        <i class="bi bi-volume-up"></i>
                        <input type="range" class="form-range" id="playerVolume" min="0" max="100" value="80" style="width: 80px;">
                    </div>
                    <button class="btn btn-sm btn-link text-body" id="playerClose" title="Close">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast container for notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer">
        {{if .Flash}}
        <div class="toast show" role="alert" data-bs-autohide="true" data-bs-delay="5000">
            <div class="toast-header bg-{{.Flash.Type}}">
                <strong class="me-auto">
                    {{if eq .Flash.Type "success"}}<i class="bi bi-check-circle me-1"></i>{{end}}
                    {{if eq .Flash.Type "error"}}<i class="bi bi-exclamation-circle me-1"></i>{{end}}
                    {{if eq .Flash.Type "warning"}}<i class="bi bi-exclamation-triangle me-1"></i>{{end}}
                    {{if eq .Flash.Type "info"}}<i class="bi bi-info-circle me-1"></i>{{end}}
                    Notification
                </strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body">{{.Flash.Message}}</div>
        </div>
        {{end}}
    </div>
</body>
</html>
{{end}}
